import getPort from 'get-port';
import {
  setupMongoose,
  buildAllIndexes,
} from 'helpers/mongo';
import {
  createRequest,
} from 'web-api/webApiRequest';
import loadEnv from '../src/server/loadEnv';
import * as mailer from 'email/mailer';

async function bootstrap() {
  const port = await getPort();
  global.testPort = port;
  loadEnv();
  await setupMongoose(`mapplaces_test_${port}`);
  await buildAllIndexes();
  mailer.initialize();
}
bootstrap();
